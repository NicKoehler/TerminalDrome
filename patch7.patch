async fn stop_playback(&mut self) {
-    self.player_status.lock().await.should_quit.store(true, Ordering::Relaxed);
+    let status = self.player_status.lock().await;
+    status.should_quit.store(true, Ordering::Relaxed);
     if let Some(mut player) = self.current_player.take() {
         let _ = player.kill();
     }
     self.status_message = "Stopped".to_string();
     self.now_playing = None;
     
-    let mut status = self.player_status.lock().await;
     status.current_index.store(usize::MAX, Ordering::Relaxed);
     status.should_quit.store(true, Ordering::Relaxed);
 }
